Lemma 5.3. There is an $n _ { 0 }$ such that the following holds for all $n \geq n _ { 0 }$ , $2 ^ { - 9 } < \varepsilon < 1$ , $c > 0$ , $r , t \geq ( \log n ) ^ { 2 }$ and $s \geq 2 0 r t$ . Let $G$ be an $n$ -vertex $( \varepsilon , c , s )$ -expander, let $U \subseteq V ( G )$ satisfy $| U | \le 2 n / 3$ . Then, in $G$ we can find either (a) $\frac { | U | } { 1 0 r }$ pairwise vertex-disjoint stars of size $t$ , whose centers are in $U$ and whose leaves are in $V ( G ) - U$ , or (b) a bipartite subgraph $H$ with vertex classes $U$ and $X \subseteq V ( G ) - U$ such that • $\begin{array} { r } { | X | \ge \frac { \varepsilon | U | } { 2 ( \log n ) ^ { c } } } \end{array}$ and • every vertex in $X$ has degree at least $r$ in $H$ and every vertex in $U$ has degree at most $2 t$ in $H$ .

Proof. Take a maximal collection $\boldsymbol { \mathscr { C } }$ of pairwise vertex-disjoint stars in $G$ with $t$ leaves, centres in $U$ and leaves outside of $U$ . Let $C \subseteq U$ be the set of centres of these stars and $L \subseteq V ( G ) - U$ be the set consisting of all their leaves. Suppose a) does not hold. Then we can assume that $\begin{array} { r } { | C | \le \frac { | U | } { 1 0 r } } \end{array}$ and thus $\begin{array} { r } { | L | = | C | \cdot t \leq \frac { | U | } { 1 0 r } \cdot t } \end{array}$ , and, by the maximality of $c$ , that there is no vertex in $U - C$ with at least $t$ neighbours in $G$ in $V ( G ) - ( U \cup L )$ . Thus,

$$
| N _ { G } ( U - C ) | \leq | C | + | L | + | U - C | \cdot t \leq { \frac { | U | } { 1 0 r } } + | C | \cdot t + | U - C | \cdot t < 2 | U | \cdot t .
$$

We now construct a set $X \subseteq V ( G ) - U$ and a bipartite subgraph $H$ with vertex classes $U$ and $X$ using the following process, starting with $X _ { 0 } = \varnothing$ and setting $H _ { 0 }$ to be the graph with vertex set $U \cup X _ { 0 }$ and no edges. Let $k = | V ( G ) - U |$ and label the vertices of $V ( G ) - U$ arbitrarily as $v _ { 1 } , \ldots , v _ { k }$ . For each $i \geq 1$ , if possible, pick a star $S _ { i }$ in $G$ with centre $v _ { i }$ and $r$ leaves in $U$ such that the vertices in $U$ in the graph $H _ { i - 1 } \cup S _ { i }$ have degree at most $2 t$ , and let $H _ { i } = H _ { i - 1 } \cup S _ { i }$ and $X _ { i } = X _ { i - 1 } \cup \{ v _ { i } \}$ , while otherwise we set $H _ { i } = H _ { i - 1 }$ and $X _ { i } = X _ { i - 1 }$ . Finally, let $H = H _ { k }$ and $X = X _ { k } = V ( H _ { k } ) - U$ . We will now show that $\mathbf { b }$ ) holds for this choice of $H$ (with vertex classes $U$ and $X$ ).

Firstly, observe that every vertex of $U$ has degree at most $2 t$ in $H _ { i }$ for each $i \in [ k ]$ by construction, and that every vertex $v _ { i }$ in $X$ has degree exactly $r$ in $H$ , so the second condition in $\mathbf { b }$ ) holds. Thus, we only need to show that |X | ≥ 2(log n)c ε|U| holds.

To see this, let $U ^ { \prime }$ be the set of vertices in $U - C$ with degree exactly $2 t$ in $H$ . As each vertex in $U - C$ has fewer than $t$ neighbours in $G$ in $X - L$ (due to the maximality of the collection of stars $\boldsymbol { \mathscr { C } }$ ), the vertices in $U ^ { \prime }$ must have at least $t$ neighbours in $H$ in $X \cap L$ . As each vertex in $X \cap L$ has $r$ neighbours in $H$ , we have

$$
| U ^ { \prime } | \leq \frac { r | X \cap L | } { t } \leq \frac { r } { t } \cdot | L | \leq \frac { r } { t } \cdot \frac { | U | \cdot t } { 1 0 r } = \frac { | U | } { 1 0 } .
$$

Let $B = C \cup U ^ { \prime }$ , so that

$$
| B | \leq \frac { | U | } { 1 0 r } + \frac { | U | } { 1 0 } \leq \frac { | U | } { 2 } ,
$$

and, thus, $\begin{array} { r } { | U - B | \ge \frac { | U | } { 2 } } \end{array}$ .

Then, by Proposition 5.2 applied to $U - B$ with $d = r$ , we have either $\begin{array} { r } { | N _ { G } ( U - B ) | \ge \frac { s | U - B | } { 2 r } } \end{array}$ or $| N _ { G , r } ( U - B ) | \geq$ ε|U−B| . As

$$
\frac { s | U - B | } { 2 r } \geq \frac { s | U | } { 4 r } \geq 5 t | U | ,
$$

the former inequality contradicts (6), so we have that $\begin{array} { r } { | N _ { G , r } ( U - B ) | \geq \frac { \varepsilon | U - B | } { ( \log n ) ^ { c } } } \end{array}$ . Every vertex $v _ { i }$ in $N _ { G , r } ( U - B )$ has at least $r$ neighbours in $G$ in $U - B$ , and vertices of $U - B$ must all have degree strictly less than $2 t$ in $H$ (as they are not in $U ^ { \prime }$ ). This implies that every $v _ { i }$ in $N _ { G , r } ( U - B )$ , satisfies $v _ { i } \in X$ , since we could add it along with some $r$ of its neighbours while constructing $H$ . Hence, $N _ { G , r } ( U - B ) \subseteq X$ , and

$$
| X | \geq | N _ { G , r } ( U - B ) | \geq \frac { \varepsilon | U - B | } { ( \log n ) ^ { c } } \geq \frac { \varepsilon | U | } { 2 ( \log n ) ^ { c } } ,
$$

as required.