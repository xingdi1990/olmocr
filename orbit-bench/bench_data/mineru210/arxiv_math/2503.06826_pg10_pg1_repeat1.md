We are now ready to prove Theorem 1.3.

Proof of Theorem 1.3. Let $X \subseteq V ( G )$ be a subset given by Lemma 2.4. We pass on to $\Gamma = G [ X ]$ . The graph $\Gamma$ has $N \geq \alpha n / 1 2 8$ vertices, and for $\beta = \alpha n / ( 8 N )$ and $d = t / 4$ , the following holds:

(i) $\Gamma$ is a $( \beta , d )$ -expander, and   
(ii) for every partition $V ( \Gamma ) = R \cup A \cup B$ with $| R | \leq \alpha N / 1 6$ and $| A | , | B | \ge \beta N / 4$ , there is an edge in $\Gamma$ between $A$ and $B$ .

Let $K = 2 5 / \alpha ^ { 2 }$ (the constant in the upper bound on the size of $T$ in Lemma 3.3). Consider the family $\mathcal { P }$ of all ordered partitions $V ( \Gamma ) = D \cup \left( \bigcup _ { i = 1 } ^ { k } W _ { i } \right) \cup U$ , where $k \geq 0$ (this can be a different number for different partitions), such that the following holds:

(P1) For ev $\begin{array} { r } { \operatorname { x y } i \in [ k ] \colon | W _ { i } | = \sqrt { \frac { 2 K N \log N } { d } } = : \ell \mathrm { ~ a n d ~ } \Gamma [ W _ { i } ] \mathrm { ~ i s ~ c o n n e c t e d } , } \end{array}$ (P2) for every two distinct $i , i ^ { \prime } \in [ k ]$ , there is an edge in $\Gamma$ between $W _ { i }$ and $W _ { i ^ { \prime } }$ , and (P3) $| D | \le \alpha N / ( 3 2 d ) \mathrm { ~ a n d ~ } | N _ { \Gamma } ( D ) \cap U | < d | D | / 2$ .

The first two properties imply that $K _ { k }$ is a minor of $\Gamma$ .

By taking $D = \emptyset$ , $k = 0$ and $U = V ( \Gamma )$ , we have that $\mathcal { P }$ is not empty. Consider a partition $V ( \Gamma ) = D \cup \left( \bigcup _ { i = 1 } ^ { k } W _ { i } \right) \cup U$ in $\mathcal { P }$ which maximises $| D |$ , tie-breaking by taking one which further maximises $k$ . We prove that then necessarily

$$
k \geq { \frac { \alpha N } { 6 4 \ell } } = : q .
$$

As $q = \Theta ( \sqrt { n t / \log n } )$ , this establishes the theorem. Suppose, towards a contradiction, that this is note the case. That is, $k < q$ . Then

$$
\vert W \vert = \left. \bigcup _ { i = 1 } ^ { k } W _ { i } \right. < \alpha N / 6 4 ,
$$

from which we conclude $| U | \ge N / 2$ , with room to spare.

The property (P3) in the proof of Theorem 1.4 is identical to the one used here, and the only property of $W$ used in the proof of Claim 3.1 and Claim 3.2 is the upper bound on $\vert W \vert$ , which is identical to the one used here. Therefore, same as in the proof of Theorem 1.4, the following holds:

• For every $i \in [ k ]$ we have $| N _ { \Gamma } ( W _ { i } ) \cap U | \geq d | W _ { i } | / 2$ , and • $\Gamma [ U ]$ is a connected $( \beta / 2 , d / 2 )$ -expander.

Now we can finish the proof using Lemma 3.3. For each $i \in [ k ]$ , set $U _ { i } = { \cal N } _ { \Gamma } ( W _ { i } ) \cap U$ . Then $| U _ { i } | \ge d \ell / 2 = : s$ . For $k < i \leq q$ , take $U _ { i } \subseteq U$ to be an arbitrary set of size $s$ . Apply Lemma 3.3 with sets $U _ { 1 } , \dots , U _ { q }$ , which we indeed can do as $q s > 2 | U |$ and $U | / s > \log | U |$ , where the former follows from $d \geq t _ { 0 } ( \alpha ) / 4$ and the latter follows from $d \leq { \sqrt { n } }$ . We obtain a subset $T \subseteq U$ of size

$$
\left| T \right| \leq K \frac { | U | } { s } \log \left( \frac { q s } { | U | } \right) \cdot \frac { \log \left| U \right| } { \log d } \leq \ell ,
$$