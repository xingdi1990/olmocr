We can now derive specific spectral properties of the Koopman operator that we will leverage for state estimation. Those properties require the following additional assumptions on the nonlinear system (6).

Assumption 3 (stable hyperbolic equilibrium). The dynamics admits a stable equilibrium at the origin, whose basin of attraction contains the polydisc $\mathbb { D } ^ { n }$ . Moreover, the eigenvalues $\lambda _ { j }$ of the Jacobian matrix $\mathcal { I } _ { F } ( \mathbf { 0 } )$ are simple and satisfy $\mathrm { R e } ( \lambda _ { j } ) < 0$ for all $j = 1 , \dotsc , n$ .

Assumption 4 (non-resonant eigenvalues). The eigenvalues $\lambda _ { j }$ of the Jacobian matrix $\mathcal { I } _ { F } ( \mathbf { 0 } )$ are nonresonant, i.e. for all $( m _ { 1 } , \ldots , m _ { n } ) \in \mathbb { N } ^ { n }$ satisfying $\begin{array} { r } { \sum _ { l = 1 } ^ { n } m _ { l } \geqslant 2 } \end{array}$ ,

$$
\lambda _ { j } \neq \sum _ { l = 1 } ^ { n } m _ { l } \lambda _ { l } , \forall j = 1 , \ldots , n .
$$

Assumption 5 (output map). The components of the output map $h$ belong to $\mathbb { H } ^ { 2 } ( \mathbb { D } ^ { n } )$ .

Remark 14 Nonresonant eigenvalues are required to rely on the PoincarÂ´e-Dulac linearization theorem. However, other linearization theorems exist, with different assumptions, see e.g. the Siegle-Bruno theorem in [Bernard, 2023]. In [Krener and MingQing, 2001], similar assumptions were considered to obtain a necessary and sufficient condition for the existence of a change of variable that linearizes the dynamics up to a nonlinear injection term.

The first remarkable property resulting from those assumptions is the fact that the operators $A _ { F }$ and $A _ { F } ^ { * }$ ad mit a series expansion that allows to represent both operators as infinite matrices.

Lemma 15 For all $f \in D ( A _ { F } )$ ,

$$
A _ { F } f = \sum _ { \alpha \in \mathbb { N } ^ { n } } \left( \sum _ { \beta \in \mathbb { N } ^ { n } } A _ { F \alpha , \beta } f _ { \beta } \right) e _ { \alpha }
$$

where $f _ { \beta } = \langle f , e _ { \beta } \rangle$ and $A _ { F \alpha , \beta } = \langle A _ { F } e _ { \beta } , e _ { \alpha } \rangle$ .

PROOF. Since $\{ e _ { \alpha } \} _ { \alpha \in \mathbb { N } ^ { n } }$ is an orthonormal basis of $\mathbb { H } ^ { 2 } ( \mathbb { D } ^ { n } )$ , any $f ~ \in ~ D ( A _ { F } )$ can be expanded as $\begin{array} { r } { f = \sum _ { \beta \in \mathbb { N } ^ { n } } f _ { \beta } e _ { \beta } . } \end{array}$ . Hence, we can prove that

$$
A _ { F } \left( \sum _ { \beta \in \mathbb { N } ^ { n } } f _ { \beta } e _ { \beta } \right) = \sum _ { \beta \in \mathbb { N } ^ { n } } f _ { \beta } A _ { F } e _ { \beta } .
$$

Indeed, in [Mugisho and Mauroy, 2024], it is shown that the right-hand side is given by

$$
\begin{array} { r l } {  { \sum _ { \beta \in \mathbb { N } ^ { n } } f _ { \beta } A _ { F } e _ { \beta } } } \\ & { = \sum _ { l = 1 } ^ { n } F _ { l } \sum _ { \beta \in \mathbb { N } ^ { n } } ( \beta _ { l } + 1 ) f _ { ( \beta _ { 1 } , \dots , \beta _ { l - 1 } , \beta _ { l } + 1 , \beta _ { l + 1 } , \dots , \beta _ { n } ) } e _ { \beta } . } \end{array}
$$

It remains to show that the left-hand side of (15) is also equal to the right-hand side of (16). To do so, consider the operators $A _ { 1 }$ and $A _ { 2 }$ given by

$$
{ \cal A } _ { 1 } f = \nabla f \mathrm { ~ a n d ~ } { \cal A } _ { 2 } \omega = { \cal F } \cdot \omega ,
$$

for all $f \in D ( A _ { F } )$ and $\omega \in ( \mathrm { H o l } ( \mathbb { D } ^ { n } ) ) ^ { n }$ , respectively. Observe that $A _ { F } = A _ { 2 } A _ { 1 }$ on $D ( A _ { F } )$ . Moreover, for all $f \in D ( A _ { F } )$ and for all $l = 1 , \ldots , n$ ,

$$
( A _ { 1 } f ) _ { l } = \sum _ { \beta \in \mathbb { N } ^ { n } } ( \beta _ { l } + 1 ) f _ { ( \beta _ { 1 } , \dots , \beta _ { l - 1 } , \beta _ { l } + 1 , \beta _ { l + 1 } , \dots , \beta _ { n } ) } e _ { \beta } .
$$

Hence, for all $f \in D ( A _ { F } )$ ,

$$
\begin{array} { l } { { \displaystyle { \cal A } _ { F } f = A _ { 2 } A _ { 1 } f } \ ~ } \\ { { \displaystyle ~ = \sum _ { l = 1 } ^ { n } F _ { l } \sum _ { \beta \in \mathbb { N } ^ { n } } ( \beta _ { l } + 1 ) f _ { ( \beta _ { 1 } , \dots , \beta _ { l - 1 } , \beta _ { l } + 1 , \beta _ { l + 1 } , \dots , \beta _ { n } ) } e _ { \beta } } . } \end{array}
$$

In view of (16), it follows that identity (15) holds, which implies that

$$
\begin{array} { l } { { \displaystyle { \cal A } _ { F } f = \sum _ { \alpha \in \mathbb { N } ^ { n } } \langle { \cal A } _ { F } f , e _ { \alpha } \rangle e _ { \alpha } } } \\ { { \displaystyle ~ = \sum _ { \alpha \in \mathbb { N } ^ { n } } \left. { \cal A } _ { F } \left( \sum _ { \beta \in \mathbb { N } ^ { n } } f _ { \beta } e _ { \beta } \right) , e _ { \alpha } \right. e _ { \alpha } } } \\ { { \displaystyle ~ = \sum _ { \alpha \in \mathbb { N } ^ { n } } \sum _ { \beta \in \mathbb { N } ^ { n } } \langle { \cal A } _ { F } e _ { \beta } , e _ { \alpha } \rangle f _ { \beta } e _ { \alpha } } . } \end{array}
$$

It is proved in [Mugisho and Mauroy, 2024] that the infinite matrix representation $\boldsymbol { \mathcal { A } } _ { F }$ of the operator $A _ { F }$ is lower block triangular of the form

$$
\mathcal { A } _ { F } f = \left( \begin{array} { c c c c c } { \left[ 0 \right] } & { \cdots } & & & \\ { \left[ 0 \right] } & { \left[ \mathcal { A } _ { 1 1 } \right] } & { \left[ 0 \right] } & { \cdots } & \\ { \left[ 0 \right] } & { \left[ \mathcal { A } _ { 2 1 } \right] } & { \left[ \mathcal { A } _ { 2 2 } \right] } & { \left[ 0 \right] } & { \cdots } \\ { \vdots } & { \vdots } & { \vdots } & { \vdots } & { \ddots } \end{array} \right) \left( \begin{array} { c } { \left[ f _ { 0 } \right] } \\ { \left[ f _ { 1 } \right] } \\ { \left[ f _ { 2 } \right] } \\ { \vdots } \end{array} \right) ,
$$