Proof. Let $g \in \Lambda$ have a non-trivial projection on $\mathbb { R } _ { \mathbf { H } }$ , and let $z \in \Lambda \cap Z$ . We have $g ^ { k } z g ^ { - k } =$ $a ^ { k } ( z )$ , where $a = r ( g )$ . Since the actions of $\scriptstyle \operatorname { \mathbb { R } } _ { \mathbf { L } }$ and $K$ on the center of Heis are trivial, and the action of $\mathbb { R } _ { \mathbf { H } }$ is contracting (up to forward or backward iteration), it follows that the sequence $( a ^ { k } ( z ) ) _ { k \in \mathbb { Z } }$ has an accumulation point at 1. As $\Lambda$ is discrete, the set $\{ a ^ { k } ( z ) , k \in \mathbb { N } \} \subset \Lambda$ must be finite, which forces $z = 1$ . 

Lemma 3.7. ([17, Lemma 5.3]) Let $Q$ be the semi-direct product $Q = \mathbb { R } \ltimes C$ where $C$ is $a$ compact connected Lie group. Then $Q$ is isomorphic to the product $\mathbb { R } \times C$ .

The last lemma we will need in this section is Lemma 3.8 below. It is similar to [16, Proposition 5.4], but we present it here in a form that allows for systematic application. The proof however is the same, so to avoid unnecessary lengthening of the paper, we will not rewrite the proof.

Let $Q \ltimes C \subset \mathsf { A u t } ( \mathsf { H e i s } )$ preserving the decomposition $\mathfrak { h e i s } = \mathfrak { a } \oplus \mathfrak { z }$ , and such that $C$ is compact. Define

$$
G : = ( Q \ltimes C ) \ltimes N .
$$

Let $\Gamma$ be a discrete subgroup of $G$ . Under some conditions, the proposition below ensures the existence of a nilpotent syndetic hull of $\Gamma$ , i.e. a connected nilpotent subgroup of $G$ containing $\Gamma$ as a lattice.

Lemma 3.8. Let $\Gamma$ be a discrete subgroup of $G$ , whose projection on $Q$ is dense. Then, up to finite index, $\Gamma$ is a lattice in a connected closed nilpotent subgroup of $G$ .

3.2. Proof of Theorem 3.1. We will examine all possible closures of the projection of $\Gamma$ to $\mathbb { R } _ { \mathbf { H } } \times \mathbb { R } _ { \mathbf { L } } \simeq \mathbb { R } ^ { 2 }$ .

Proposition 3.9. If $\overline { { p ( \Gamma ) } } = \mathbb { R } _ { \mathbf { H } } \times \mathbb { R } _ { \mathbf { L } }$ , then $\Gamma$ does not act properly discontinuously and cocompactly on $X$ .

Proof. By Lemma 3.8, $\Gamma$ is a cocompact lattice in a connected nilpotent subgroup $N$ of $G$ . We will show that $N \cap { \mathsf { H e i s } } \neq \{ 1 \}$ . Our claim is that $\mathrm { d i m } N \geq n + 2$ . Indeed, $\Gamma$ acts properly and cocompactly on the $K ( \pi , 1 )$ space $N / C \simeq \mathbb { R } ^ { k }$ , where $C$ is the maximal compact subgroup of $N$ . So its cohomological dimension is equal to $\mathrm { d i m } ( N / C )$ . On the other hand, since $\Gamma$ also acts properly and cocompactly on $X = \mathbb { R } ^ { n + 2 }$ , its cohomological dimension must be $n + 2$ . This implies that $\dim N / C = n + 2$ . Now, decompose $N$ as $N = \mathbb { R } \times N _ { 1 }$ , where the $\mathbb { R }$ -factor is generated by a one-parameter subgroup of $G$ with a nontrivial projection on $\mathbb { R } _ { \mathbf { L } }$ , and where

$$
N _ { 1 } : = N \cap ( \mathbb { R } _ { \mathbf { H } } \times K ) \ltimes { \mathsf { H e i s } } ,
$$

satisfies $\dim N _ { 1 } \geq n + 1$ . We have $p _ { \mathbf { H } } ( N _ { 1 } ) = \mathbb { R }$ , so we further decompose $N _ { 1 }$ as $N _ { 1 } = \mathbb { R } \times N _ { 0 }$ , where the $\mathbb { R }$ -factor is a one-parameter subgroup $s ( t )$ of $( \mathbb { R } _ { \mathbf { H } } \times K ) \ltimes \mathsf { H e i s }$ that has a nontrivial projection on $\mathbb { R } _ { \mathbf { H } }$ , and

$$
N _ { 0 } : = N _ { 1 } \cap ( K \ltimes \mathsf { H e i s } ) ,
$$

with $\dim N _ { 0 } \geq n$ . Since $N _ { 0 }$ is nilpotent, its projection to $K$ is an abelian subgroup of ${ \mathsf { O } } ( n )$ , whose maximal possible dimension is $\left\lfloor { \frac { n } { 2 } } \right\rfloor$ . Consequently, $N _ { 0 }$ must intersect Heis nontrivially. Moreover, $N _ { 1 }$ contains the subgroup $\dot { s } ( t ) \ltimes \left( N _ { 0 } \cap \mathsf { H e i s } \right)$ , which is therefore nilpotent. However, since the action of $s ( t )$ on $N _ { 0 } \cap$ Heis is semisimple (and unipotent), it must be trivial. This is impossible since $s ( t )$ projects non-trivially on $\mathbb { R } _ { \mathbf { H } }$ , so its real eigenvalues are all different from 1 (the real eigenvalues of its projection to $K$ are all equal to $1$ ). 

Proposition 3.10. If $\overline { { p ( \Gamma ) } } = \mathbb { R }$ , the action of $\Gamma$ is properly discontinuous and cocompact if and only if $\Gamma$ is contained in the isometry group.

Proof. We have a short exact sequence $1 \to K \ltimes \mathsf { H e i s } \to G \to \mathbb { R } _ { \mathbf { L } } \times \mathbb { R } _ { \mathbf { H } } \to 1$ . Let $\mathbb { R } _ { \mathbf { T } } =$ $\{ e ^ { t T } , t \in \mathbb { R } \}$ be a one-parameter subgroup of $G$ such that $p ( \mathbb { R } _ { \mathbf { T } } ) = \overline { { p ( \Gamma ) } }$ . Then, $\Gamma$ is contained in $G _ { 1 } : = \mathbb { R } _ { \mathbf { T } } \ltimes \left( K \ltimes \mathsf { H e i s } \right)$ .

We will show that this group is, in fact, isomorphic to a group of the form $( \mathbb { R } \times K ) \ltimes \mathsf { H e i s }$ . Write $\mathbf { T } = \lambda + \Phi + \omega$ , with $\lambda \in \mathbb { R } H \oplus \mathbb { R } L$ , $\Phi \in { \mathfrak { k } }$ , and $\omega \in { \mathfrak { h e i s } }$ . For any $\Psi \in { \mathfrak { k } }$ , we have

$$
[ \mathbf { T } , \boldsymbol { \Psi } ] = [ \boldsymbol { \Phi } , \boldsymbol { \Psi } ] + [ \boldsymbol { \omega } , \boldsymbol { \Psi } ] \in \boldsymbol { \mathfrak { k } } \times \mathfrak { h e i s } .
$$