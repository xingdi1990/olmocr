## 4.3 Spectral analysis

We can now derive specific spectral properties of the Koopman operator that we will leverage for state estimation. Those properties require the following additional assumptions on the nonlinear system (6).

Assumption 3 (stable hyperbolic equilibrium). The dynamics admits a stable equilibrium at the origin, whose basin of attraction contains the polydisc ID". Moreover, the eigenvalues x; of the Jacobian matrix Jp(0) are simple and satisfy Re(x;) < 0 for all j = 1, . . . , n.

Assumption 4 (non-resonant eigenvalues). The eigenvalues ); of the Jacobian matrix JF(0) are nonresonant, i.e. for all (m1, ... , mn) E N" satisfying Li=1 mi > 2,

$$
\lambda\_j \neq \sum\_{l=1}^n m\_l \lambda\_l, \forall j = 1, \dots, n.
$$

Assumption 5 (output map). The components of the output map h belong to H2(D").

Remark 14 Nonresonant eigenvalues are required to rely on the Poincar√©-Dulac linearization theorem. However, other linearization theorems exist, with different assumptions, see e.g. the Siegle-Bruno theorem in [Bernard, 2023]. In [Krener and MingQing, 2001], similar assumptions were considered to obtain a necessary and sufficient condition for the existence of a change of variable that linearizes the dynamics up to a nonlinear injection term.

The first remarkable property resulting from those assumptions is the fact that the operators AF and Ap admit a series expansion that allows to represent both operators as infinite matrices.

Lemma 15 For all f E D(AF),

$$A\_F f = \sum\_{\alpha \in \mathbb{N}^n} \left( \sum\_{\beta \in \mathbb{N}^n} A\_{F\alpha,\beta} f\_\beta \right) e\_\alpha$$

where fB = (f,eB) and AFa.B = (AFeB, ea).

PROOF. Since {ea}aENn is an orthonormal basis of H2(D"), any f E D(Ar) can be expanded as f = BENn fBeB. Hence, we can prove that

$$A\_F\left(\sum\_{\beta \in \mathbb{N}^n} f\_\beta e\_\beta\right) = \sum\_{\beta \in \mathbb{N}^n} f\_\beta A\_F e\_\beta. \tag{15}$$

Indeed, in [Mugisho and Mauroy, 2024], it is shown that the right-hand side is given by

$$\begin{split} \sum\_{\beta \in \mathbb{N}^n} f\_{\beta} A\_F e\_{\beta} \\ = \sum\_{l=1}^n F\_l \sum\_{\beta \in \mathbb{N}^n} (\beta\_l + 1) f\_{(\beta\_1, \dots, \beta\_{l-1}, \beta\_l + 1, \beta\_{l+1}, \dots, \beta\_n)} e\_{\beta} . \end{split} \tag{16}$$

It remains to show that the left-hand side of (15) is also equal to the right-hand side of (16). To do so, consider the operators A1 and A2 given by

$$A\_1 f = \nabla f \text{ and } A\_2 \omega = F \cdot \omega,$$

for all f E D(Ap) and w E (Hol(D")), respectively. Observe that AF = A2A1 on D(AF). Moreover, for all f & D(AF) and for all l = 1, .. , n,

$$(A\_1 f)\_l = \sum\_{\beta \in \mathbb{N}^n} (\beta\_l + 1) f\_{\{\beta\_1, \dots, \beta\_{l-1}, \beta\_l + 1, \beta\_{l+1}, \dots, \beta\_n\}} e\_{\beta\_l}.$$

Hence, for all f E D(AF),

$$\begin{aligned} A\_F f &= A\_2 A\_1 f \\ &= \sum\_{l=1}^n F\_l \sum\_{\beta \in \mathbb{N}^n} (\beta\_l + 1) f\_{\{\beta\_1, \dots, \beta\_{l-1}, \beta\_l + 1, \beta\_{l+1}, \dots, \beta\_n\}} e\_{\beta\_l} \end{aligned}$$

In view of (16), it follows that identity (15) holds, which implies that

$$\begin{split} A\_{F}f &= \sum\_{\alpha \in \mathbb{N}^{n}} \langle A\_{F}f, e\_{\alpha} \rangle e\_{\alpha} \\ &= \sum\_{\alpha \in \mathbb{N}^{n}} \left\langle A\_{F} \left( \sum\_{\beta \in \mathbb{N}^{n}} f\_{\beta} e\_{\beta} \right), e\_{\alpha} \right\rangle e\_{\alpha} \\ &= \sum\_{\alpha \in \mathbb{N}^{n}} \sum\_{\beta \in \mathbb{N}^{n}} \langle A\_{F} e\_{\beta}, e\_{\alpha} \rangle f\_{\beta} e\_{\alpha} .\end{split}$$

It is proved in [Mugisho and Mauroy, 2024] that the infinite matrix representation AF of the operator AF is lower block triangular of the form

$$\mathcal{A}\_F f = \begin{pmatrix} [0] & \cdots & & \\ [0] \ [\mathcal{A}\_{11}] & [0] & \cdots & \\ [0] \ [\mathcal{A}\_{21}] \ [\mathcal{A}\_{22}] & [0] & \cdots \\ \vdots & \vdots & \vdots & \ddots \end{pmatrix} \begin{pmatrix} [f\_0] \\ [f\_1] \\ [f\_2] \\ \vdots \end{pmatrix},\tag{17}$$