![](_page_0_Figure_0.jpeg)

Fig. 1. An RIS-assisted point-to-point MIMO communication system.

predesigned codebook for RIS-assisted point-to-point MIMO communications. In contrast to the direct codeword selection from the predesigned codebook, the proposed scheme designs a set of weights for each codeword in the codebook according to the corresponding output results, yielding a new RIS RC vector. For illustration, we contrast the proposed scheme to its existing channel estimation, passive beamforming and predesigned codebook counterparts in Table I. The simulation results demonstrate that the proposed scheme has improved performance compared to existing passive beamforming and codebook schemes.

## IL SYSTEM MODEL

We consider an RIS-assisted point-to-point MIMO system in a single cell as shown in Fig. 1, where a base station (BS) with Mt transmit antennas sends Ms data streams to a user with Mr antennas, with Ms ≤ min { Mt, Mr}. The RIS consists of N reflecting elements and is equipped with a smart controller capable of adjusting the RCs according to instructions from the BS. The signals from both the cascaded BS-RIS-user link and the direct BS-user link are superimposed at the user. We assume that the frequency-flat baseband equivalent channels spanning from the BS to the RIS, from the RIS to the user, and from the BS to the user are denoted by Ht E CN xMt , Hr E CMr×N and Ha E CMx XMt, respectively.

Let & = [01, 92, ··· , YN]" represent the RIS RC vector, where on = e30% denotes the RC of the nth RIS element with phase shift 0n, satisfying 0n E [0,2n) for n = 1,2, ... , N. Thus the composite end-to-end channel He E CMr×Mt from the BS to the user can be expressed as

$$\mathbf{H}\_c = \mathbf{H}\_d + \mathbf{H}\_r \text{diag}(\varphi) \mathbf{H}\_t. \tag{1}$$

During the channel training process in the uplink phase, the user sends the pilot signal X = [x1, X2, . . . , XMr] = CM+×+ to the BS, where xm E C1×T,m = 1, 2, ··· , Mr is the pilot loaded on the mth antenna at the user. The pilot matrix satisfies |X = = TPu, where pu is the average pilot power. As we consider a time-division duplexing protocol for both uplink as well as downlink transmissions and assume the channel's reciprocity, the pilot signal received at the BS is given by

$$\mathbf{Y} = \mathbf{H}\_{\boldsymbol{\epsilon}}^H \mathbf{X} + \mathbf{N}\_{\rm BS},\tag{2}$$

where NBS E CM+XT denotes the noise matrix at the BS with an average noise power of of ofs, whose ith column vector follows nBS,i ~ CN (OM+, oBsIMt), for i = 1, 2, ... , T. We employ mutually orthogonal pilots, and the length of the pilot signal is designed such that T ≥ Mx [12].

Next, we consider the downlink of data transmission where the BS applies a baseband precoder W = CMz x Ms to transmit symbol s E CMs x1, with E { ss " } = IMs. Furthermore, the precoder satisfies || W||2 < pa and pa is the total transmit power at the BS. Thus the received signal at the user is obtained as

$$\mathbf{r} = \mathbf{H}\_e \mathbf{W} \mathbf{s} + \mathbf{n}\_{\text{UE}},\tag{3}$$

where nUE E CMr×1 is the noise at the user with an average noise power of of of , satisfying nuE ~ CN (0M, , OUEIM, ).

Meanwhile, we adopt the Rician channel in this paper. Specifically, the RIS-user channel can be expressed as

$$\mathbf{H}\_{r} = \sqrt{\beta\_{r}} \left( \sqrt{\frac{F\_{r}}{F\_{r} + 1}} \mathbf{H}\_{r}^{\mathrm{LoS}} + \sqrt{\frac{1}{F\_{r} + 1}} \mathbf{H}\_{r}^{\mathrm{NLoS}} \right), \qquad (4)$$

where Br and Fr are the path loss and the Rician factor of RIS-user channel, respectively; HLOS E CMx×N and HNLoS E CMrxN represent the line-of-sight (LoS) and the non-line-of-sight (NLoS) components of the RIS-user channel, respectively. The element on the myth row and the nth column of the NLoS matrix is modeled by Rayleigh fading, which follows H. S. m. ~ C.V (0, 1). Similarly, the BS-user channel and BS-RIS channel can be modeled by using (4).

Moreover, we consider a uniform linear array (ULA) at the BS, a ULA at the user, and a uniform planar array (UPA) at the RIS. Let aBS (8) E CM+×1, aUE (δ) E CM+×1 and aR (5, Y) E CNx1 denote the steering vector of the BS, the user and the RIS, respectively. Specifically, the moth entry of aps is denoted as ej =(m+-1)dbs sin(8), mt = 1, 2, ... , Mt, where dbs denotes the element spacing of the BS, > denotes the signal wavelength, and & E [-T/2, T/2) denotes the angle of departure (AoD) or the angle of arrival (AoA). Similarly, the myth entry of aue is denoted as ej = (mr -1)due sin(d), mor = 1, 2, . . . , Mr, where duE denotes the element spacing of the user. The nth entry of an is denoted
as 1, 2, ... , N, where dR denotes the element spacing of the RIS. No is the number of elements deployed at each row of the RIS. < E [0, T) and Y E [-T/2, T/2) denote the azimuth and elevation AoA/AoD, respectively. Thus, the LoS component of the Ht, Hr and Ha are given by ar (CAOA, yaoA) aBs (SpoD)H 11, 11, and 122 are ground of aux (5, and and aug (62,000) abs (62,000 ) H
aut (6,004) ar (5,000 , And And Appel (6,200 , Barcesent the AoD, the azimuth and elevation AoA from the BS to the RIS, respectively; SAOA, CAOD and you represent the AoA, the azimuth and elevation AoD from the RIS to the user, respectively; of 0A and 840D represent the AoA and the AoD from the BS to the user, respectively.

In the next section, unlike traditional passive beamforming and codebook schemes, the proposed scheme maximizes the channel capacity of the point-to-point MIMO systems by