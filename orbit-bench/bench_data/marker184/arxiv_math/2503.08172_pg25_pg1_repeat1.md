Therefore, assuming that the first child of the root is  $j \in \{1, \ldots, d\}$  (equivalently, that the minimal label of  $\sigma^{(j)} \sqcup \bigsqcup_{l \neq j} \sigma^{(l)}$  belongs to the *j*th component), and using this counting principle, one get the recursive formula

$$d(\varnothing,\sigma) = \left(\sum_{j=1}^{d} \frac{|\sigma^{(j)}|}{|\sigma|-1} w_{\emptyset,j}\right) \binom{|\sigma|-1}{|\sigma^{(1)}|,\ldots,|\sigma^{(d)}|} \prod_{k=1}^{d} d_k(\varnothing,\sigma^{(k)}),\tag{4.17}$$

where  $d_k$  denotes the combinatorial dimension in which the weights  $w_{i,ij}$  are replaced by  $w_{ki,kij}$ , and  $\binom{n}{k_1,\dots,k_d}$  denotes the usual multinomial coefficient.

Thereafter, the proof of the lemma follows by induction.

By using Lemma  $4.1$ , we obtain results similar to those in Theorem  $3.1$ . The proof follows from simple calculations and is omitted.

Corollary 4.3. The normalized extremal NNHFs of this WBD take the form  $\mathbf{v}$ 

$$\varphi(\tau) = \prod_{i \in \tau} \alpha_i \prod_{i \in \overset{\circ}{\tau}} \frac{\alpha_i}{\sum_{j=1}^d \alpha_{ij} w_{i,ij}},\tag{4.18}$$

 $\Box$ 

 $\Box$ 

with  $\alpha_{\emptyset} = 1$  and  $\alpha_i = \alpha_{i1} + \ldots + \alpha_{id} \in [0,1]$  for any  $i \in \mathcal{S}_d$ . Again, the  $\alpha_i$  represents the  $asymptotic proportion of descendants of i in a regular path.$ 

Besides, the corresponding saturated ergodic central Markov kernel is then given by

$$p(\tau,\tau \sqcup \{ij\}) = \begin{cases} \frac{\alpha_{ij}w_{i,ij}}{\sum_{k=1}^{d}\alpha_{ik}w_{i,ik}}\alpha_{i}, & \text{if } i \in \partial\tau, \\ \alpha_{ij}, & \text{if } i \notin \partial\tau \text{ and } ij \notin \tau, \end{cases}$$
(4.19)

for any  $i \in \tau$  and  $j \in \{1, \ldots, d\}$ .

As a consequence, we obtain the following generalization of Han's hook length formula  $(4.3)$ . **Corollary 4.4.** Let  $\mathcal{B}_d(n)$  be the set of all d-ary trees with n vertices. Then

$$\sum_{\tau \in \mathcal{B}_d(n)} \frac{\prod_{v \in \overset{\circ}{\tau}} \frac{\sum_{j=1}^d |\tau^{(v_j)}| w_j}{|\tau^{(v)}| - 1}}{\prod_{v \in \tau} |\tau^{(v)}| d^{|\tau^{(v)}| - 1}} \left(\frac{w_1 + \dots + w_d}{d}\right)^{|\partial \tau|} = \frac{1}{n!} \left(\frac{w_1 + \dots + w_d}{d}\right)^n. \tag{4.20}$$

*Proof.* Consider the uniform fragmentation measure case as in Section 4.1, that is  $\alpha_i = d^{-|i|}$ and  $w_{i,ij} \equiv w_j$  for all  $i \in \mathcal{S}_d$  and  $1 \leq j \leq d$ .

By using  $(4.2)$  and by noting that

$$\prod_{i \in \overset{\circ}{\tau}} \frac{\alpha_i}{\sum_{j=1}^d \alpha_{ij} w_{i,ij}} = \left(\frac{d}{\sum_{j=1}^d w_j}\right)^{|\tau| - |\partial \tau|},\tag{4.21}$$

we deduce the result from  $(4.18)$  and the general combinatorial identity  $(7.5)$ .

As an example, when  $d = 2$  and  $n = 3$ , we obtain

$$\frac{1}{6} \left(\frac{w_1 + w_2}{2}\right)^3 = \frac{1}{12} \left(\frac{w_1 + w_2}{2}\right)^3 + \frac{1}{48} \sum_{1 \le i,j \le 2} w_i w_j \left(\frac{w_1 + w_2}{2}\right).$$

It is much more difficult to describe the MERWs in full generality. However, drawing on the previous situation, one can construct them using appropriate IDLA-like random walks under some additional assumptions.