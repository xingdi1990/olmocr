![](_page_0_Figure_0.jpeg)

Fig. 1. An RIS-assisted point-to-point MIMO communication system.

predesigned codebook for RIS-assisted point-to-point MIMO communications. In contrast to the direct codeword selection from the predesigned codebook, the proposed scheme designs a set of weights for each codeword in the codebook according to the corresponding output results, yielding a new RIS RC vector. For illustration, we contrast the proposed scheme to its existing channel estimation, passive beamforming and predesigned codebook counterparts in Table I. The simulation results demonstrate that the proposed scheme has improved performance compared to existing passive beamforming and codebook schemes.

## II. SYSTEM MODEL

We consider an RIS-assisted point-to-point MIMO system in a single cell as shown in Fig. 1, where a base station (BS) with  $M_t$  transmit antennas sends  $M_s$  data streams to a user with  $M_r$  antennas, with  $M_s \leq \min \{M_t, M_r\}$ . The RIS consists of  $N$  reflecting elements and is equipped with a smart controller capable of adjusting the RCs according to instructions from the BS. The signals from both the cascaded BS-RIS-user link and the direct BS-user link are superimposed at the user. We assume that the frequency-flat baseband equivalent channels spanning from the BS to the RIS, from the RIS to the user, and from the BS to the user are denoted by  $\mathbf{H}_t \in \mathbb{C}^{N \times M_t}, \mathbf{H}_r \in$  $\mathbb{C}^{M_r \times N}$  and  $\mathbf{H}_d \in \mathbb{C}^{M_r \times M_t}$ , respectively.

Let  $\boldsymbol{\varphi} = [\varphi_1, \varphi_2, \cdots, \varphi_N]^T$  represent the RIS RC vector, where  $\varphi_n = e^{j\theta_n}$  denotes the RC of the *n*th RIS element with phase shift  $\theta_n$ , satisfying  $\theta_n \in [0, 2\pi)$  for  $n = 1, 2, \dots, N$ . Thus the composite end-to-end channel  $\mathbf{H}_e \in \mathbb{C}^{\overset{\sim}{M_r} \times \overset{\sim}{M_t}}$  from the BS to the user can be expressed as

$$\mathbf{H}_e = \mathbf{H}_d + \mathbf{H}_r \text{diag}(\boldsymbol{\varphi}) \mathbf{H}_t. \tag{1}$$

During the channel training process in the uplink phase, the user sends the pilot signal  $\mathbf{X} = [\mathbf{x}_1, \mathbf{x}_2, \cdots, \mathbf{x}_{M_r}]^T \in \mathbb{C}^{M_r \times \tau}$ to the BS, where  $\mathbf{x}_m^T \in \mathbb{C}^{1 \times \tau}, m = 1, 2, \cdots, M_r$  is the pilot loaded on the  $m$ th antenna at the user. The pilot matrix satisfies  $\|\mathbf{X}\|_{F}^{2} = \tau p_{u}$ , where  $p_{u}$  is the average pilot power. As we consider a time-division duplexing protocol for both uplink as well as downlink transmissions and assume the channel's reciprocity, the pilot signal received at the BS is given by

$$\mathbf{Y} = \mathbf{H}_e^H \mathbf{X} + \mathbf{N}_{\text{BS}},\tag{2}$$

where  $\mathbf{N}_{\mathrm{BS}} \in \mathbb{C}^{M_t \times \tau}$  denotes the noise matrix at the BS with an average noise power of  $\sigma_{\rm BS}^2$ , whose *i*th column vector follows  $\mathbf{n}_{\text{BS},i} \sim \mathcal{CN}\left(\mathbf{0}_{M_t}, \sigma_{\text{BS}}^2 \mathbf{I}_{M_t}\right)$ , for  $i = 1, 2, \cdots, \tau$ . We employ mutually orthogonal pilots, and the length of the pilot signal is designed such that  $\tau \geq M_r$  [12].

Next, we consider the downlink of data transmission where the BS applies a baseband precoder  $\mathbf{W} \in \mathbb{C}^{M_t \times M_s}$  to transmit symbol  $\mathbf{s} \in \mathbb{C}^{M_s \times 1}$ , with  $\mathbb{E} \left\{ \mathbf{s} \mathbf{s}^H \right\} = \mathbf{I}_{M_s}$ . Furthermore, the precoder satisfies  $\|\mathbf{W}\|_{F}^{2} \leq p_{d}$  and  $p_{d}$  is the total transmit power at the BS. Thus the received signal at the user is obtained as

$$\mathbf{r} = \mathbf{H}_e \mathbf{W} \mathbf{s} + \mathbf{n}_{\text{UE}},\tag{3}$$

where  $\mathbf{n}_{\text{UE}} \in \mathbb{C}^{M_r \times 1}$  is the noise at the user with an average noise power of  $\sigma_{\text{UE}}^2$ , satisfying  $\mathbf{n}_{\text{UE}} \sim \mathcal{CN} \left( \mathbf{0}_{M_r}, \sigma_{\text{UE}}^2 \mathbf{I}_{M_r} \right)$ .

Meanwhile, we adopt the Rician channel in this paper. Specifically, the RIS-user channel can be expressed as

$$\mathbf{H}_{r} = \sqrt{\beta_{r}} \left( \sqrt{\frac{F_{r}}{F_{r}+1}} \mathbf{H}_{r}^{\text{LoS}} + \sqrt{\frac{1}{F_{r}+1}} \mathbf{H}_{r}^{\text{NLoS}} \right), \quad (4)$$

where  $\beta_r$  and  $F_r$  are the path loss and the Rician factor of RIS-user channel, respectively;  $\mathbf{H}^{\mathrm{LoS}}_{r} \in \mathbb{C}^{M_{r} \times N}$  and  $\mathbf{H}_{r}^{\text{NLoS}} \in \mathbb{C}^{M_{r} \times N}$  represent the line-of-sight (LoS) and the non-line-of-sight (NLoS) components of the RIS-user channel, respectively. The element on the  $m_r$ th row and the nth column of the NLoS matrix is modeled by Rayleigh fading, which follows  $\mathbf{H}_{r}^{\text{NLoS}}_{m_{r},n} \sim \mathcal{CN}(0,1)$ . Similarly, the BS-user channel and BS-RIS channel can be modeled by using (4).

Moreover, we consider a uniform linear array (ULA) at the BS, a ULA at the user, and a uniform planar array (UPA) at the RIS. Let  $\mathbf{a}_{\text{BS}}\left(\delta\right) \in \mathbb{C}^{M_t \times 1}$ ,  $\mathbf{a}_{\text{UE}}\left(\delta\right) \in \mathbb{C}^{M_r \times 1}$ and  $\mathbf{a}_{\mathrm{R}}(\zeta,\gamma) \in \mathbb{C}^{N\times 1}$  denote the steering vector of the BS, the user and the RIS, respectively. Specifically, the  $m_t$ th entry of  $\mathbf{a}_{\text{BS}}$  is denoted as  $e^{j\frac{2\pi}{\lambda}(m_t-1)d_{\text{BS}}\sin(\delta)}, m_t =$  $1, 2, \cdots, M_t$ , where  $d_{\text{BS}}$  denotes the element spacing of the BS,  $\lambda$  denotes the signal wavelength, and  $\delta \in [-\pi/2, \pi/2)$ denotes the angle of departure (AoD) or the angle of arrival (AoA). Similarly, the  $m_r$ th entry of  $\mathbf{a}_{\text{UE}}$  is denoted as  $e^{j\frac{2\pi}{\lambda}(m_r-1)d_{\text{UE}}\sin(\delta)}, m_r = 1, 2, \cdots, M_r$ , where  $d_{\text{UE}}$  denotes the element spacing of the user. The *n*th entry of  $\mathbf{a}_{\mathsf{R}}$  is denoted as  $e^{j2\pi d_{\mathsf{R}}\sin(\gamma)\left[\lfloor\frac{n-1}{N_x}\rfloor\sin(\zeta)+((n-1)-\lfloor\frac{n-1}{N_x}\rfloor N_x)\cos(\zeta)\right]/\lambda}$ ,  $n =$  $1, 2, \dots, N$ , where  $d_{\mathbb{R}}$  denotes the element spacing of the RIS.  $N_x$  is the number of elements deployed at each row of the RIS.  $\zeta \in [0,\pi)$  and  $\gamma \in [-\pi/2,\pi/2)$  denote the azimuth and elevation AoA/AoD, respectively. Thus, the LoS component of the  $\begin{array}{l} \mathbf{H}_{t}, \ \mathbf{H}_{r} \ \text{and} \ \mathbf{H}_{d} \ \text{are given by } \mathbf{a}_{\mathsf{R}} \left( \zeta_{t}^{\text{AoA}}, \gamma_{t}^{\text{AoA}} \right) \mathbf{a}_{\mathsf{BS}} \left( \delta_{t}^{\text{AoD}} \right)^{H}, \\ \mathbf{a}_{\mathsf{UE}} \left( \delta_{r}^{\text{AoA}} \right) \mathbf{a}_{\mathsf{R}} \left( \zeta_{r}^{\text{AoD}}, \gamma_{r}^{\text{AoD}} \right)^{H} \ \text{and} \ \mathbf{a}_{\mathsf{UE}} \$ the azimuth and elevation AoA from the BS to the RIS, respectively;  $\delta_r^{\text{AoA}}$ ,  $\zeta_r^{\text{AoD}}$  and  $\gamma_r^{\text{AoD}}$  represent the AoA, the azimuth and elevation AoD from the RIS to the user, respectively;  $\delta_d^{\text{AoA}}$ and  $\delta_d^{\text{AoD}}$  represent the AoA and the AoD from the BS to the user, respectively.

In the next section, unlike traditional passive beamforming and codebook schemes, the proposed scheme maximizes the channel capacity of the point-to-point MIMO systems by