## $4.3$ Spectral analysis

We can now derive specific spectral properties of the Koopman operator that we will leverage for state estimation. Those properties require the following additional assumptions on the nonlinear system  $(6)$ .

Assumption 3 (stable hyperbolic equilibrium). The dynamics admits a stable equilibrium at the origin, whose basin of attraction contains the polydisc  $\overline{\mathbb{D}^n}$ . Moreover, the eigenvalues  $\lambda_j$  of the Jacobian matrix  $\mathcal{J}_F(\mathbf{0})$  are simple and satisfy  $\text{Re}(\lambda_i) < 0$  for all  $j=1,\ldots,n.$ 

Assumption 4 (non-resonant eigenvalues). The eigenvalues  $\lambda_i$  of the Jacobian matrix  $\mathcal{J}_F(\mathbf{0})$  are nonresonant, i.e. for all  $(m_1,\ldots,m_n) \in \mathbb{N}^n$  satisfying  $\sum_{l=1}^{n} m_l \geqslant 2,$ 

$$\lambda_j \neq \sum_{l=1}^n m_l \lambda_l, \ \forall j = 1, \dots, n.$$

Assumption 5 (output map). The components of the output map h belong to  $\mathbb{H}^2(\mathbb{D}^n)$ .

**Remark 14** Nonresonant eigenvalues are required to rely on the PoincarÃ©-Dulac linearization theorem. However, other linearization theorems exist, with different assumptions, see e.g. the Siegle-Bruno theorem in [Bernard, 2023]. In [Krener and MingQing, 2001], similar assumptions were considered to obtain a necessary and sufficient condition for the existence of a change of variable that linearizes the dynamics up to a nonlinear injection term.

The first remarkable property resulting from those assumptions is the fact that the operators  $A_F$  and  $A_F^*$  admit a series expansion that allows to represent both operators as infinite matrices.

**Lemma 15** For all  $f \in D(A_F)$ ,

$$A_F f = \sum_{\alpha \in \mathbb{N}^n} \left( \sum_{\beta \in \mathbb{N}^n} A_{F\alpha,\beta} f_\beta \right) e_\alpha$$

where  $f_{\beta} = \langle f, e_{\beta} \rangle$  and  $A_{F_{\alpha,\beta}} = \langle A_F e_{\beta}, e_{\alpha} \rangle$ .

**PROOF.** Since  $\{e_{\alpha}\}_{{\alpha}\in\mathbb{N}^n}$  is an orthonormal basis of  $\mathbb{H}^2(\mathbb{D}^n)$ , any  $f \in D(A_F)$  can be expanded as  $f = \sum_{\beta \in \mathbb{N}^n} f_{\beta} e_{\beta}$ . Hence, we can prove that

$$A_F \left( \sum_{\beta \in \mathbb{N}^n} f_\beta e_\beta \right) = \sum_{\beta \in \mathbb{N}^n} f_\beta A_F e_\beta. \tag{15}$$

Indeed, in [Mugisho and Maurov, 2024], it is shown that the right-hand side is given by

$$\sum_{\beta \in \mathbb{N}^n} f_{\beta} A_F e_{\beta}$$

$$= \sum_{l=1}^n F_l \sum_{\beta \in \mathbb{N}^n} (\beta_l + 1) f_{(\beta_1, \dots, \beta_{l-1}, \beta_l + 1, \beta_{l+1}, \dots, \beta_n)} e_{\beta}.$$
(16)

It remains to show that the left-hand side of  $(15)$  is also equal to the right-hand side of  $(16)$ . To do so, consider the operators  $A_1$  and  $A_2$  given by

$$A_1 f = \nabla f \text{ and } A_2 \omega = F \cdot \omega,$$

for all  $f \in D(A_F)$  and  $\omega \in (\text{Hol}(\mathbb{D}^n))^n$ , respectively. Observe that  $A_F = A_2 A_1$  on  $D(A_F)$ . Moreover, for all  $f \in D(A_F)$  and for all  $l = 1, \ldots, n$ ,

$$(A_1f)_l = \sum_{\beta \in \mathbb{N}^n} (\beta_l + 1) f_{(\beta_1, \dots, \beta_{l-1}, \beta_l + 1, \beta_{l+1}, \dots, \beta_n)} e_{\beta}.$$

Hence, for all  $f \in D(A_F)$ ,

$$A_F f = A_2 A_1 f$$
  
=  $\sum_{l=1}^n F_l \sum_{\beta \in \mathbb{N}^n} (\beta_l + 1) f_{(\beta_1, \dots, \beta_{l-1}, \beta_l + 1, \beta_{l+1}, \dots, \beta_n)} e_\beta.$ 

In view of  $(16)$ , it follows that identity  $(15)$  holds, which implies that

$$\begin{split} A_F f &= \sum_{\alpha \in \mathbb{N}^n} \langle A_F f, e_\alpha \rangle e_\alpha \\ &= \sum_{\alpha \in \mathbb{N}^n} \left\langle A_F \left( \sum_{\beta \in \mathbb{N}^n} f_\beta e_\beta \right), e_\alpha \right\rangle e_\alpha \\ &= \sum_{\alpha \in \mathbb{N}^n} \sum_{\beta \in \mathbb{N}^n} \left\langle A_F e_\beta, e_\alpha \right\rangle f_\beta \, e_\alpha. \end{split}$$

It is proved in [Mugisho and Mauroy, 2024] that the infinite matrix representation  $\mathcal{A}_F$  of the operator  $A_F$  is lower block triangular of the form

$$\mathcal{A}_{F}f = \begin{pmatrix} [0] & \cdots & & \\ [0] & [\mathcal{A}_{11}] & [0] & \cdots & \\ [0] & [\mathcal{A}_{21}] & [\mathcal{A}_{22}] & [0] & \cdots \\ \vdots & \vdots & \vdots & \vdots & \ddots \end{pmatrix} \begin{pmatrix} [f_{0}] \\ [f_{1}] \\ [f_{2}] \\ \vdots \end{pmatrix}, \qquad (17)$$